<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A fully featured admin theme which can be used to build CRM, CMS, etc.">
    <meta name="author" content="Coderthemes">

    <link rel="shortcut icon" href="images/favicon_1.ico">

    <title>添加</title>


    <!-- Base Css Files -->
    <link href="__PUBLIC__/css/bootstrap.min.css" rel="stylesheet" />

    <!-- Font Icons -->
    <link href="__PUBLIC__/assets/font-awesome/css/font-awesome.min.css" rel="stylesheet" />
    <link href="__PUBLIC__/assets/ionicon/css/ionicons.min.css" rel="stylesheet" />
    <link href="__PUBLIC__/css/material-design-iconic-font.min.css" rel="stylesheet">

    <!-- animate css -->
    <link href="__PUBLIC__/css/animate.css" rel="stylesheet" />

    <!-- Waves-effect -->
    <link href="__PUBLIC__/css/waves-effect.css" rel="stylesheet">

    <!-- sweet alerts -->
    <link href="__PUBLIC__/assets/sweet-alert/sweet-alert.min.css" rel="stylesheet">

    <!-- Custom Files -->
    <link href="__PUBLIC__/css/helper.css" rel="stylesheet" type="text/css" />
    <link href="__PUBLIC__/css/style.css" rel="stylesheet" type="text/css" />

    <link href="__PUBLIC__/assets/uploadify/uploadify.css" rel="stylesheet" type="text/css" />



    <!-- Plugins css-->
    <link href="__PUBLIC__/assets/tagsinput/jquery.tagsinput.css" rel="stylesheet" />
    <link href="__PUBLIC__/assets/toggles/toggles.css" rel="stylesheet" />
    <link href="__PUBLIC__/assets/timepicker/bootstrap-timepicker.min.css" rel="stylesheet" />
    <link href="__PUBLIC__/assets/timepicker/bootstrap-datepicker.min.css" rel="stylesheet" />
    <link href="__PUBLIC__/assets/timepicker/bootstrap-datetimepicker.min.css" rel="stylesheet" />
    <link href="__PUBLIC__/assets/colorpicker/colorpicker.css" rel="stylesheet" type="text/css" />
    <link href="__PUBLIC__/assets/jquery-multi-select/multi-select.css"  rel="stylesheet" type="text/css" />
    <link href="__PUBLIC__/assets/select2/select2.css" rel="stylesheet" type="text/css" />

    <link href="__PUBLIC__/assets/summernote/summernote.css" rel="stylesheet" />



    <script src="__PUBLIC__/js/jquery.min.js"></script>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="__PUBLIC__/js/modernizr.min.js"></script>





</head>



<body class="fixed-left">

<!-- Begin page -->
<div id="wrapper">

    <!-- Top Bar Start -->
    <include file="Public:top" />
    <!-- Top Bar End -->


    <!-- ========== Left Sidebar Start ========== -->
    <include file="Public:left" />
    <!-- Left Sidebar End -->



    <!-- ============================================================== -->
    <!-- Start right Content here -->
    <!-- ============================================================== -->
    <div class="content-page">
        <!-- Start content -->
        <div class="content">
            <div class="container">

                <!-- Form-validation -->
                <div class="row">

                    <div class="col-sm-12">
                        <div class="panel panel-default">
                            <div class="panel-heading"><h3 class="panel-title">添加</h3></div>
                            <div class="panel-body">
                                <div class=" form">
                                    <form method="post" action="{:U('Vote/doAdd')}" onSubmit="return checkForm();">

                                        <div class="form-group ">
                                            <label for="vote_title" class="control-label col-12">名字</label>
                                            <div class="col-12">
                                                <input style="width: 50%" class=" form-control" id="vote_title" name="vote_title" type="text" value="">
                                            </div>
                                        </div>


                                        <div class="form-group ">
                                            <label for="start_time" class="control-label col-12">开始时间</label>
                                            <div class="input-group col-12" style="width:300px;">
                                                <input name="vote_start_time"   type="text" class="form-control" placeholder="年-月-日 时:分" id="start_time">
                                                <span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
                                            </div>
                                        </div>

                                        <div class="form-group ">
                                            <label for="end_time" class="control-label col-12">结束时间</label>
                                            <div class="input-group col-12" style="width:300px;">
                                                <input name="vote_end_time" type="text" class="form-control" placeholder="年-月-日 时:分" id="end_time">
                                                <span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
                                            </div>
                                        </div>




                                        <div class="form-group col-12">
                                            <label for="vote_mac_c" class="control-label col-12">能选择几票</label>
                                            <div id="spinner3">
                                                <div class="input-group" id="vote_mac_c" style="width:150px;">
                                                    <input type="text" name="vote_max_c" class="spinner-input form-control" maxlength="3" readonly>
                                                    <div class="spinner-buttons input-group-btn">
                                                        <button type="button" class="btn btn-info spinner-up waves-effect">
                                                            <i class="fa fa-angle-up"></i>
                                                        </button>
                                                        <button type="button" class="btn btn-pink spinner-down waves-effect">
                                                            <i class="fa fa-angle-down"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="form-group col-12">
                                            <label for="vote_page_rows" class="control-label col-12">每页几项</label>
                                            <div id="spinner_page">
                                                <div class="input-group" id="vote_page_rows" style="width:150px;">
                                                    <input type="text" name="vote_page_rows" class="spinner-input form-control" maxlength="3" readonly>
                                                    <div class="spinner-buttons input-group-btn">
                                                        <button type="button" class="btn btn-info spinner-up waves-effect">
                                                            <i class="fa fa-angle-up"></i>
                                                        </button>
                                                        <button type="button" class="btn btn-pink spinner-down waves-effect">
                                                            <i class="fa fa-angle-down"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>




                                        <div class="form-group ">
                                            <label for="vote_is_open" class="control-label col-12">是否开启(勾选表示开启)</label>
                                            <div class="col-12 " >
                                                <div class="checkbox checkbox-success checkbox-inline">
                                                    <input type="checkbox"  id="vote_is_open" class="checkbox  form-control"  name="vote_is_open" checked="checked">
                                                    <label for="inlineCheckbox1"> </label>
                                                </div>

                                            </div>
                                        </div>


                                        <div class="form-group ">
                                            <label for="vote_is_detail" class="control-label col-12">是否开启详细页(勾选表示开启)</label>
                                            <div class="col-12 " >
                                                <div class="checkbox checkbox-success checkbox-inline">
                                                    <input type="checkbox"  id="vote_is_detail" class="checkbox  form-control"  name="vote_is_detail">
                                                    <label for="inlineCheckbox1"> </label>
                                                </div>

                                            </div>
                                        </div>


                                        <div class="form-group ">
                                            <label for="vote_description" class="control-label col-12">描述</label>
                                            <div class="col-12">
                                                <div class="summernote_description"></div>
                                                <input type="hidden" class=" form-control" id="vote_description" name="vote_description" type="text" value="">
                                            </div>
                                        </div>

                                        <div class="form-group ">
                                            <label for="vote_bottominfo" class="control-label col-12">底部信息</label>
                                            <div class="col-12">
                                                <div class="summernote_bottominfo"></div>
                                                <input type="hidden" class=" form-control" id="vote_bottominfo" name="vote_bottominfo" type="text" value="">
                                            </div>
                                        </div>




                                        <div class="form-group ">
                                            <label for="vote_img" class="control-label col-12">头部图片</label>
                                            <div class="input-group">
                                                <div class="avatar_box">
                                                    <img id="vote_img" src="" width="130" height="130" border="0" />
                                                    <div class="upload_avatar">
                                                        <input name="vote_img" type="hidden"  value=""/>
                                                        <input id="file_upload" name="file_upload" type="file" multiple="true" value="" />
                                                    </div>
                                                </div>

                                            </div>
                                        </div>

                                        <hr/>
                                        <div >




                                        </div>

                                        <div class="row" id="">
                                            <div class="col-md-10">
                                                <div class="panel panel-default">
                                                    <!--<div class="panel-heading">
                                                        <h3 class="panel-title">Responsive Table</h3>
                                                    </div>-->
                                                    <div class="panel-body">
                                                        <div class="row">
                                                            <div class="col-md-12 col-sm-12 col-xs-12">
                                                                <div class="table-responsive">
                                                                    <table class="table">
                                                                        <thead>
                                                                        <tr>
                                                                            <th>图片</th>
                                                                            <th>描述</th>
                                                                            <th>排序</th>
                                                                            <th>操作</th>
                                                                        </tr>
                                                                        </thead>
                                                                        <tbody id="opt_list">



                                                                        </tbody>
                                                                    </table>

                                                                    <div id="add_opt" class="btn btn-success " >添加选项</div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div> <!-- End row -->



                                        <div class="form-group">
                                            <div class="col-lg-offset-2 col-lg-10">
                                                <button id="submitBtn" class="btn btn-success waves-effect waves-light" type="submit">　　　保存　　　</button>
                                                <br/><br/><br/>
                                            </div>
                                        </div>
                                    </form>














                            </div> <!-- panel-body -->
                        </div> <!-- panel -->
                    </div> <!-- col -->

                </div> <!-- End row -->



            </div> <!-- container -->

        </div> <!-- content -->

        <footer class="footer text-right">
            2015 © 技术中心.{$Think.cookie.PHPSESSID}aa
        </footer>

    </div>
    <!-- ============================================================== -->
    <!-- End Right content here -->
    <!-- ============================================================== -->




</div>
<!-- END wrapper -->

<script>
    var resizefunc = [];
</script>

<!-- jQuery  -->
<script src="__PUBLIC__/js/jquery.min.js"></script>
<script src="__PUBLIC__/js/bootstrap.min.js"></script>
<script src="__PUBLIC__/js/waves.js"></script>
<script src="__PUBLIC__/js/wow.min.js"></script>
<script src="__PUBLIC__/js/jquery.nicescroll.js" type="text/javascript"></script>
<script src="__PUBLIC__/js/jquery.scrollTo.min.js"></script>
<script src="__PUBLIC__/assets/jquery-detectmobile/detect.js"></script>
<script src="__PUBLIC__/assets/fastclick/fastclick.js"></script>
<script src="__PUBLIC__/assets/jquery-slimscroll/jquery.slimscroll.js"></script>
<script src="__PUBLIC__/assets/jquery-blockui/jquery.blockUI.js"></script>


<!-- CUSTOM JS -->
<script src="__PUBLIC__/js/jquery.app.js"></script>

<script src="__PUBLIC__/assets/tagsinput/jquery.tagsinput.min.js"></script>
<script src="__PUBLIC__/assets/toggles/toggles.min.js"></script>
<!--<script src="__PUBLIC__/assets/timepicker/bootstrap-timepicker.min.js"></script>
<script src="__PUBLIC__/assets/timepicker/bootstrap-timepicker.js"></script>-->
<script src="__PUBLIC__/assets/timepicker/bootstrap-datetimepicker.min.js"></script>
<script src="__PUBLIC__/assets/timepicker/bootstrap-datetimepicker.zh-CN.js"></script>

<script  src="__PUBLIC__/assets/colorpicker/bootstrap-colorpicker.js" type="text/javascript"></script>
<script  src="__PUBLIC__/assets/jquery-multi-select/jquery.multi-select.js" type="text/javascript"></script>
<script  src="__PUBLIC__/assets/jquery-multi-select/jquery.quicksearch.js" type="text/javascript"></script>
<script src="__PUBLIC__/assets/bootstrap-inputmask/bootstrap-inputmask.min.js" type="text/javascript"></script>
<script  src="__PUBLIC__/assets/spinner/spinner.min.js" type="text/javascript"></script>
<script src="__PUBLIC__/assets/select2/select2.min.js" type="text/javascript"></script>
<script src="__PUBLIC__/assets/uploadify/jquery.uploadify.min.js" type="text/javascript"></script>


<script src="__PUBLIC__/assets/summernote/summernote.min.js"></script>
<script src="__PUBLIC__/assets/summernote/summernote-zh-CN.js"></script>



<script>

    var imgRootPath = '__ROOT__'

    jQuery(document).ready(function() {


        //日期选择
        $('#start_time').datetimepicker({
            language:  'zh-CN',
            weekStart: 1,
            todayBtn:  1,
            autoclose: 1,
            todayHighlight: 1,
            startView: 2,
            forceParse: 0,
            showMeridian: 1
        });

        //日期选择
        $('#end_time').datetimepicker({
            language:  'zh-CN',
            weekStart: 1,
            todayBtn:  1,
            autoclose: 1,
            todayHighlight: 1,
            startView: 2,
            forceParse: 0,
            showMeridian: 1
        });


        //最大选择次数
        $('#spinner3').spinner({value:1, min: 1, max: 100});

        $('#spinner_page').spinner({value:10, min: 1, max: 100});



        //头部图片上传函数
        $('#file_upload').uploadify({
            'swf'      : '__PUBLIC__/assets/uploadify/uploadify.swf',
            'uploader' : "{:U('Upload/pictuieUpload',array('PHPSESSID'=> cookie('PHPSESSID')))}",
            'buttonText' : '上传图片',
            'onUploadSuccess' : function(file, data, response) {
                $('#vote_img').attr('src','__ROOT__/vote/Uploads/Picture/'+data);
                $("input[name='vote_img']").val(data);
            },
        });


        //选项图片上传函数
        function addUploaddify(id){
            $("#option_img_upload_"+id).uploadify({
                'swf'      : '__PUBLIC__/assets/uploadify/uploadify.swf',
                'uploader' : "{:U('Upload/pictuieUpload',array('PHPSESSID'=> cookie('PHPSESSID')))}",
                'buttonText' : '上传图片',
                'onUploadSuccess' : function(file, data, response) {
                    $("img[name='option_img'][id='"+id+"']").attr('src','__ROOT__/vote/Uploads/Picture/'+data);
                    $("input[name='option_img[]'][id='"+id+"']").val(data);
                },
            });
        }


        //添加选项
        var addId = 0;
        $("#add_opt").click(function(){
            addId = addId+1;
            var id= 0-addId;//变成负数，表示添加。

           var html='';
            html += '<tr>';
            html += '<td>';
            html += '<div class="input-group">';
            html += '<div class="avatar_box">';
            html += '<img name="option_img" id="'+id+'" src="" width="130" height="130" border="0" />';
            html += '<div class="upload_avatar">';
            html += '<input type="hidden" name="option_img[]" id="'+id+'" value=""/>';
            html += '<input id="option_img_upload_'+id+'"  name="option_img_upload" type="file" multiple="true" value="" />';
            html += '</div>';
            html += '</div>';
            html += '</div>';
            html += '</td>';
            html += '<td>';
            html += '<input class="form-control" id="'+id+'"  name="option_name[]" type="text" value="">';
            html += '</td>';
            html += '<td>';
            html += '<input type="hidden" name="option_id[]" id="'+id+'" value="'+id+'"/>';
            html += '<input style="width: 50px" id="'+id+'"  name="option_order[]" type="text" value="100">';
            html += '</td>';
            html += '<td>';
            html += '<div name="option_del" id="'+id+'" class="btn btn-primary waves-effect waves-light">删除</div>';
            html += '</td>';
            html += '</tr>';

            $('#opt_list').append(html);

            addUploaddify(id);

        });

        //选项卡删除、这里采用on来监听异步加载的内容
        $(document).on("click","div[name='option_del']",function(){
            $(this).parents('tr').remove();

        });


        $('.summernote_description').summernote({
            lang:'zh-CN',
            height: 200,                 // set editor height
            width: 650,
            minHeight: null,             // set minimum height of editor
            maxHeight: null,             // set maximum height of editor
            focus: false,                // set focus to editable area after initializing summernote

            toolbar: [
                //[groupname, [button list]]

                ['style', ['bold', 'italic', 'underline', 'clear']],
                ['fontsize', ['fontsize']],
                ['color', ['color']],
                ['para', ['ul', 'ol', 'paragraph']],
                ['height', ['height']],
                ['Insert', ['hr']],
            ]


        });


        $('.summernote_bottominfo').summernote({
            lang:'zh-CN',
            height: 200,                 // set editor height
            width: 650,
            minHeight: null,             // set minimum height of editor
            maxHeight: null,             // set maximum height of editor
            focus: false,                 // set focus to editable area after initializing summernote

            toolbar: [
                //[groupname, [button list]]

                ['style', ['bold', 'italic', 'underline', 'clear']],
                ['fontsize', ['fontsize']],
                ['color', ['color']],
                ['para', ['ul', 'ol', 'paragraph']],
                ['height', ['height']],
                ['Insert', ['hr']],
            ]

        });






    });


    function checkForm(){

        //alert("hahah");

        $("#vote_description").val($('.summernote_description').code());
        $("#vote_bottominfo").val($('.summernote_bottominfo').code());
        //alert($('.summernote_description').code());
        //alert($('.summernote_bottominfo').code());




        return true;





    }















</script>



</body>
</html>